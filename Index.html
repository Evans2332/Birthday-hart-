<!-- Save as birthday-heart-3d.html and open in a browser -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Birthday Heart — 3D</title>
  <style>
    html,body { height:100%; margin:0; background:#0b0212; overflow:hidden; }
    #container{width:100%;height:100%}
    .credit { position: absolute; left:12px; bottom:12px; color:rgba(255,255,255,0.6); font-family: sans-serif; font-size:12px; }
  </style>
</head>
<body>
  <div id="container"></div>
  <div class="credit">Happy Birthday — save & share!</div>

  <script type="module">
  import * as THREE from 'https://unpkg.com/three@0.152.2/build/three.module.js';
  import { OrbitControls } from 'https://unpkg.com/three@0.152.2/examples/jsm/controls/OrbitControls.js';

  const container = document.getElementById('container');
  const scene = new THREE.Scene();
  scene.fog = new THREE.FogExp2(0x0b0212, 0.055);

  const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 100);
  camera.position.set(0, 1.2, 3.5);

  const renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth, innerHeight);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
  renderer.setClearColor(0x0b0212);
  container.appendChild(renderer.domElement);

  const controls = new OrbitControls(camera, renderer.domElement);
  controls.enablePan = false;
  controls.minDistance = 1.8;
  controls.maxDistance = 6;
  controls.enableDamping = true;
  controls.autoRotate = false;

  // Lights
  const hemi = new THREE.HemisphereLight(0xffe5f3, 0x220022, 0.9);
  scene.add(hemi);
  const key = new THREE.PointLight(0xff70b8, 1.2, 10);
  key.position.set(2, 2, 2);
  scene.add(key);
  const fill = new THREE.PointLight(0x7fb5ff, 0.5, 10);
  fill.position.set(-2, -1, -2);
  scene.add(fill);

  // create a heart Shape (approximation)
  const heartShape = new THREE.Shape();
  heartShape.moveTo(0, -0.5);
  heartShape.bezierCurveTo(0, -0.5, -0.6, -1.0, -1.1, -0.3);
  heartShape.bezierCurveTo(-1.6, 0.6, -0.2, 1.05, 0, 0.7);
  heartShape.bezierCurveTo(0.2, 1.05, 1.6, 0.6, 1.1, -0.3);
  heartShape.bezierCurveTo(0.6, -1.0, 0, -0.5, 0, -0.5);

  // Extrude the shape to make it 3D
  const extrudeSettings = { depth: 0.5, bevelEnabled: true, bevelThickness: 0.06, bevelSize: 0.06, bevelSegments: 6, steps: 1 };
  const geometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettings);
  geometry.center(); // center geometry

  // Material with slight sheen
  const material = new THREE.MeshPhysicalMaterial({
    color: 0xff3d7f,
    metalness: 0.25,
    roughness: 0.35,
    clearcoat: 0.25,
    clearcoatRoughness: 0.05,
    reflectivity: 0.5
  });

  const heart = new THREE.Mesh(geometry, material);
  heart.scale.set(1.2,1.2,1.2);
  scene.add(heart);

  // small particles/glow behind heart
  const particleGeo = new THREE.BufferGeometry();
  const count = 400;
  const positions = new Float32Array(count*3);
  for(let i=0;i<count;i++){
    const r = THREE.MathUtils.randFloat(1.4, 3.5);
    const theta = Math.random()*Math.PI*2;
    const phi = THREE.MathUtils.randFloat(-0.6, 0.6);
    positions[i*3] = Math.cos(theta)*r*Math.cos(phi);
    positions[i*3+1] = Math.sin(phi)*r*0.6 + 0.2;
    positions[i*3+2] = Math.sin(theta)*r*Math.cos(phi);
  }
  particleGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
  const pMat = new THREE.PointsMaterial({ size: 0.02, transparent:true, opacity:0.9, depthWrite:false, color:0xffb3d1 });
  const particles = new THREE.Points(particleGeo, pMat);
  scene.add(particles);

  // create a canvas texture for the message
  function createMessageTexture(text, subtext){
    const w = 1024, h = 256;
    const c = document.createElement('canvas');
    c.width = w; c.height = h;
    const ctx = c.getContext('2d');
    ctx.fillStyle = 'rgba(0,0,0,0)';
    ctx.fillRect(0,0,w,h);
    ctx.textAlign = 'center';
    ctx.fillStyle = '#fff';
    ctx.font = '70px "Segoe UI", Roboto, sans-serif';
    ctx.fillText(text, w/2, 110);
    ctx.font = '34px "Segoe UI", Roboto, sans-serif';
    ctx.fillStyle = 'rgba(255,255,255,0.9)';
    ctx.fillText(subtext, w/2, 170);
    const tex = new THREE.CanvasTexture(c);
    tex.needsUpdate = true;
    return tex;
  }

  const msgTex = createMessageTexture('Happy Birthday, Emma!', 'All my love — Evan');
  const planeMat = new THREE.MeshBasicMaterial({ map: msgTex, transparent:true });
  const plane = new THREE.Mesh(new THREE.PlaneGeometry(2.2, 0.55), planeMat);
  plane.position.set(0, -1.0, 0);
  scene.add(plane);

  // animation loop
  const clock = new THREE.Clock();
  function animate(){
    requestAnimationFrame(animate);
    const t = clock.getElapsedTime();

    // heart pulse
    const pulse = 1 + 0.06 * Math.sin(t*3.2);
    heart.scale.set(pulse*1.1, pulse*1.1, pulse*1.1);
    heart.rotation.y += 0.005;

    // gentle particle rotation
    particles.rotation.y = Math.sin(t*0.2)*0.2;

    // subtle camera movement
    camera.position.x = Math.sin(t*0.25) * 0.18;
    camera.position.y = 1.2 + Math.sin(t*0.12)*0.05;
    camera.lookAt(0,0.1,0);

    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  // responsive
  window.addEventListener('resize', ()=> {
    camera.aspect = innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
  });
  </script>
</body>
</html>
